<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline' *; script-src 'self'  'unsafe-inline' 'unsafe-eval' *;">
        <meta name="viewport" content="width=device-width, user-scalable=no" />
        <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="assets/css/navbar.css">
        <link rel="stylesheet" href="assets/css/dog.css">
        <link rel="stylesheet" href="assets/css/font/fonts.css">
        <link rel="stylesheet" href="assets/css/bootstrap-toggle.min.css">
        <style>
            .col-xs-7{
                text-align: right;
            }
        </style>
    </head>
    <body>
        <div id="loader" style="opacity: 1;"><img src="assets/images/loader2.gif"></div>
        <div id="page-content">
            <div class="container">
                <div class="jumbotron">
                    <div style="font-size: 130%">
                        <img src="assets/images/turn20.png"  style="width: 40px"/>
                        การแจ้งเตือน</div><hr><br>
                    <div class="checkbox">
                        <div class="row">
                            <label class="col-xs-7">ประกาศขอเลือด: </label>             
                            <input type="checkbox" class="col-xs-5" id="request" data-toggle="toggle" data-on="เปิด" data-off="ปิด">
                        </div>
                    </div><br>
                    <div class="checkbox">
                        <div class="row">
                            <label class="col-xs-7">ข้อความส่วนตัว: </label>
                            <input type="checkbox" class="col-xs-5" id="pm" data-toggle="toggle" data-on="เปิด" data-off="ปิด">
                        </div>
                    </div><br>
                    <div class="checkbox">
                        <div class="row">
                            <label class="col-xs-7">มีผู้บริจาค: </label>
                            <input type="checkbox" class="col-xs-5" id="requester" data-toggle="toggle" data-on="เปิด" data-off="ปิด">
                        </div>
                    </div><br>
                    <div class="checkbox">
                        <div class="row">
                            <label class="col-xs-7">สถานะการบริจาค: </label>
                            <input type="checkbox" class="col-xs-5" id="donator" data-toggle="toggle" data-on="เปิด" data-off="ปิด">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="cordova.js"></script>
        <script src="assets/js/jquery.js"></script>
        <script src="assets/js/jquery.transit.min.js"></script>
        <script src="assets/js/base.js"></script>
        <script src="assets/js/functions.js"></script>
        <script src="assets/js/autoload.js"></script>
        <script src="assets/bootstrap/js/bootstrap.min.js"></script>
        <script src="assets/js/bootstrap-toggle.min.js"></script>
        <script>
            $(function () {
                removeLoader();
                setTitle("การตั้งค่า");
                displayName();
                setMenu("nav-setting");

                $.ajax({
                    type: 'POST',
                    url: api + 'user/settings_get.php',
                    dataType: 'json',
                    data: {"token": token},
                    success: function (data) {
                        $.each(data, function (i, setting) {
                            console.log(setting);
                            if (setting.value == 1) {
                                $("#" + setting.type).bootstrapToggle('on');
                            } else {
                                $("#" + setting.type).bootstrapToggle('off');
                            }
                        });

                        $('input[type=checkbox]').change(function () {
                            window.plugins.spinnerDialog.show("กำลังบันทึกข้อมูล","กรุณารอสักครู่", true);
                            var elem = $(this);
                            $(this).attr("disabled", "disabled");
                            var type = $(this).attr("id");
                            var val = $(this).prop("checked");
                            var value = 0;
                            if (val == true) {
                                value = 1;
                            }
                            $.ajax({
                                type: 'POST',
                                url: api + 'user/settings_save.php',
                                dataType: 'json',
                                data: {"token": token, "type": type, "value": value},
                                success: function (data) {
                                    console.log(data);
                                    setTimeout(function () {
                                        elem.removeAttr("disabled");
                                        window.plugins.spinnerDialog.hide();
                                    }, 500);
                                }
                            });
                        })

                    }
                });
            });
        </script>
    </body>
</html>